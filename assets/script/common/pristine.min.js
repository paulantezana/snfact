!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).Pristine=r()}(this,function(){"use strict";var t={required:"Este campo es requerido",email:"Este campo requiere una dirección de correo electrónico válida",number:"Este campo requiere un número",url:"Este campo requiere una URL de sitio web válida",tel:"Este campo requiere un número de teléfono válido",maxlength:"La longitud de estos campos debe ser < ${1}",minlength:"La longitud de estos campos debe ser > ${1}",min:"El valor mínimo para este campo es ${1}",max:"El valor máximo para este campo es ${1}",pattern:"Por favor rellena el formato requerido"};function f(e){var t=arguments;return this.replace(/\${([^{}]*)}/g,function(e,r){return t[r]})}function n(e){return e.pristine.self.form.querySelectorAll('input[name="'+e.getAttribute("name")+'"]:checked').length}function s(e,r){r.name=e,r.msg||(r.msg=t[e]),void 0===r.priority&&(r.priority=1),v[e]=r}var p={classTo:"SnForm-item",errorClass:"has-error",successClass:"has-success",errorTextParent:"SnForm-item",errorTextTag:"div",errorTextClass:"SnForm-help"},m="pristine-error",d=["required","min","max","minlength","maxlength","pattern"],r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,v={};function e(e,r,t){var n,i,s,a=this;function o(e,r,t,n){var i=v[t];if(i&&(e.push(i),n)){var s=n.split(",");s.unshift(null),r[t]=s}}function l(e){var r,t=[],n=!0;for(var i in e.validators){var s=e.validators[i],o=e.params[s.name]?e.params[s.name]:[];if(o[0]=e.input.value,!s.fn.apply(e.input,o)){if(n=!1,(r=s.msg)&&r.constructor&&r.call&&r.apply)t.push(s.msg(e.input.value,o));else{var a=e.messages[s.name]||s.msg;t.push(f.apply(a,o))}if(!0===s.halt)break}}return e.errors=t,n}function u(e){if(e.errorElements)return e.errorElements;var r=function(e,r){for(;(e=e.parentElement)&&!e.classList.contains(r););return e}(e.input,a.config.classTo),t=null,n=null;return(t=a.config.classTo===a.config.errorTextParent?r:r.querySelector("."+a.config.errorTextParent))&&((n=t.querySelector("."+m))||((n=document.createElement(a.config.errorTextTag)).className=m+" "+a.config.errorTextClass,t.appendChild(n),n.pristineDisplay=n.style.display)),e.errorElements=[r,n]}function c(e){var r=u(e),t=r[0],n=r[1];t&&(t.classList.remove(a.config.successClass),t.classList.add(a.config.errorClass)),n&&(n.innerHTML=e.errors.join("<br/>"),n.style.display=n.pristineDisplay||"")}return i=r,s=t,(n=e).setAttribute("novalidate","true"),a.form=n,a.config=function(e,r){for(var t in r)t in e||(e[t]=r[t]);return e}(i||{},p),a.live=!(!1===s),a.fields=Array.from(n.querySelectorAll("input:not([type^=hidden]):not([type^=submit]), select, textarea")).map(function(e){var t=[],n={},i={};return[].forEach.call(e.attributes,function(e){if(/^data-pristine-/.test(e.name)){var r=e.name.substr(14);if(r.endsWith("-message"))return void(i[r.slice(0,r.length-8)]=e.value);"type"===r&&(r=e.value),o(t,n,r,e.value)}else~d.indexOf(e.name)?o(t,n,e.name,e.value):"type"===e.name&&o(t,n,e.value)}),t.sort(function(e,r){return r.priority-e.priority}),a.live&&e.addEventListener(~["radio","checkbox"].indexOf(e.getAttribute("type"))?"change":"input",function(e){a.validate(e.target)}.bind(a)),e.pristine={input:e,validators:t,params:n,messages:i,self:a}}.bind(a)),a.validate=function(e,r){r=e&&!0===r||!0===e;var t=a.fields;!0!==e&&!1!==e&&(e instanceof HTMLElement?t=[e.pristine]:(e instanceof NodeList||e instanceof(window.$||Array)||e instanceof Array)&&(t=Array.from(e).map(function(e){return e.pristine})));var n,i=!0;for(var s in t){var o=t[s];l(o)?r||(n=void 0,(n=function(e){var r=u(e),t=r[0],n=r[1];t&&(t.classList.remove(a.config.errorClass),t.classList.remove(a.config.successClass));n&&(n.innerHTML="",n.style.display="none");return r}(o)[0])&&n.classList.add(a.config.successClass)):(i=!1,r||c(o))}return i},a.getErrors=function(e){if(e)return e.length?e[0].pristine.errors:e.pristine.errors;for(var r=[],t=0;t<a.fields.length;t++){var n=a.fields[t];n.errors.length&&r.push({input:n.input,errors:n.errors})}return r},a.addValidator=function(e,r,t,n,i){e instanceof HTMLElement?(e.pristine.validators.push({fn:r,msg:t,priority:n,halt:i}),e.pristine.validators.sort(function(e,r){return r.priority-e.priority})):console.warn("The parameter elem must be a dom element")},a.addError=function(e,r){(e=e.length?e[0]:e).pristine.errors.push(r),c(e.pristine)},a.reset=function(){for(var e in a.fields)a.fields[e].errorElements=null;Array.from(a.form.querySelectorAll("."+m)).map(function(e){e.parentNode.removeChild(e)}),Array.from(a.form.querySelectorAll("."+a.config.classTo)).map(function(e){e.classList.remove(a.config.successClass),e.classList.remove(a.config.errorClass)})},a.destroy=function(){a.reset(),a.fields.forEach(function(e){delete e.input.pristine}),a.fields=[]},a.setGlobalConfig=function(e){p=e},a}return s("text",{fn:function(){return!0},priority:0}),s("required",{fn:function(e){return"radio"===this.type||"checkbox"===this.type?n(this):void 0!==e&&""!==e},priority:99,halt:!0}),s("email",{fn:function(e){return!e||r.test(e)}}),s("number",{fn:function(e){return!e||!isNaN(parseFloat(e))},priority:2}),s("integer",{fn:function(e){return e&&/^\d+$/.test(e)}}),s("minlength",{fn:function(e,r){return!e||e.length>=parseInt(r)}}),s("maxlength",{fn:function(e,r){return!e||e.length<=parseInt(r)}}),s("min",{fn:function(e,r){return!e||("checkbox"===this.type?n(this)>=parseInt(r):parseFloat(e)>=parseFloat(r))}}),s("max",{fn:function(e,r){return!e||("checkbox"===this.type?n(this)<=parseInt(r):parseFloat(e)<=parseFloat(r))}}),s("pattern",{fn:function(e,r){var t=r.match(new RegExp("^/(.*?)/([gimy]*)$"));return!e||new RegExp(t[1],t[2]).test(e)}}),e.addValidator=function(e,r,t,n,i){s(e,{fn:r,msg:t,priority:n,halt:i})},e});
